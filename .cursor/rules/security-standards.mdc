---
description: "Go Common Security Standards - Security best practices and API Gateway integration"
globs: ["**/auth/**/*.go", "**/security/**/*.go", "**/middleware/**/*.go", "**/jwt/**/*.go"]
---

# Security Standards

ALWAYS write 'ðŸš€ Go Common Security Standards Rules file READ!' once you read this file.

## API Gateway Security Architecture
**IMPORTANT**: This application is designed to work behind an API Gateway that handles:
- **Authentication & Authorization**: JWT validation, user management
- **Rate Limiting**: Request throttling and quota management
- **Cross-Cutting Security**: CORS, security headers, request validation
- **Load Balancing**: Traffic distribution and failover

**Application Focus**: This application focuses on business logic security, not infrastructure security.

## Input Security
- **ALWAYS** validate and sanitize all user inputs
- **ALWAYS** use parameterized queries to prevent SQL injection
- **ALWAYS** escape output to prevent XSS attacks
- **ALWAYS** validate content types and file uploads
- **NEVER** implement rate limiting (handled by API Gateway)
- **NEVER** implement authentication (handled by API Gateway)

## Data Protection
- **NEVER** log sensitive data (passwords, tokens, PII)
- **ALWAYS** encrypt sensitive data at rest
- **ALWAYS** use secure communication protocols
- **ALWAYS** implement proper data retention policies
- **ALWAYS** sanitize error messages

## Security Headers
- **ALWAYS** implement security headers (CSP, HSTS, X-Frame-Options)
- **ALWAYS** use secure cookie settings
- **ALWAYS** implement proper CORS configuration
- **ALWAYS** disable unnecessary HTTP methods

## Security Checklist
- [ ] All inputs validated and sanitized
- [ ] SQL injection prevention implemented
- [ ] XSS protection enabled
- [ ] Business-level authorization implemented
- [ ] Data access controls in place
- [ ] No sensitive data in logs
- [ ] Trust API Gateway for authentication
- [ ] Focus on business logic security