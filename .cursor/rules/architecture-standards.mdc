---
description: "Go Common Architecture Standards - Layer separation, dependency flow, and interface design"
globs: ["**/internal/**/*.go", "**/handlers/**/*.go", "**/services/**/*.go", "**/repositories/**/*.go"]
---

# Architecture Standards

ALWAYS write 'ðŸš€ Go Common Architecture Standards Rules file READ!' once you read this file.

## Layer Separation (CRITICAL)
```
API Gateway Layer â†’ API Layer (handlers/) â†’ Business Layer (services/) â†’ Repository Layer (repositories/) â†’ Database Layer (database/)
```

**API Gateway Responsibilities:**
- Authentication & Authorization
- Rate Limiting & Throttling
- Request Routing & Load Balancing
- Cross-cutting Security Concerns
- CORS & Security Headers

**Application Layer Responsibilities:**
- Business Logic Implementation
- Data Validation & Sanitization
- Database Operations
- Error Handling & Logging

## Directory Structure
```
hello/
â”œâ”€â”€ engine/              # Go microservice
â”‚   â”œâ”€â”€ internal/
â”‚   â”‚   â”œâ”€â”€ config/      # Configuration management
â”‚   â”‚   â”œâ”€â”€ container/   # Dependency injection
â”‚   â”‚   â”œâ”€â”€ database/    # Database connection
â”‚   â”‚   â”œâ”€â”€ errors/      # Error handling
â”‚   â”‚   â”œâ”€â”€ handlers/    # HTTP handlers
â”‚   â”‚   â”œâ”€â”€ logger/      # Logging
â”‚   â”‚   â”œâ”€â”€ middleware/  # HTTP middleware
â”‚   â”‚   â”œâ”€â”€ migrate/     # Database migrations
â”‚   â”‚   â”œâ”€â”€ models/      # Data models
â”‚   â”‚   â”œâ”€â”€ repositories/# Data access
â”‚   â”‚   â”œâ”€â”€ services/    # Business logic
â”‚   â”‚   â””â”€â”€ validation/  # Input validation
â”‚   â””â”€â”€ migrations/      # Database migrations
â”œâ”€â”€ ui/                  # React frontend
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/  # React components
â”‚   â”‚   â”œâ”€â”€ api/         # API client
â”‚   â”‚   â”œâ”€â”€ utils/       # Utility functions
â”‚   â”‚   â””â”€â”€ config.ts    # Configuration
â”‚   â””â”€â”€ config/          # Environment configs
â””â”€â”€ api-gateway/         # API gateway
    â””â”€â”€ internal/
        â”œâ”€â”€ auth/        # Authentication
        â”œâ”€â”€ config/      # Configuration
        â”œâ”€â”€ limiter/     # Rate limiting
        â”œâ”€â”€ middleware/  # Middleware
        â”œâ”€â”€ proxy/       # Request proxying
        â””â”€â”€ redis/       # Redis client
```

## Dependency Flow
- **ALWAYS** inject dependencies from outer layers to inner layers
- **NEVER** import from inner layers in outer layers
- **USE** interfaces for all dependencies
- **IMPLEMENT** dependency injection container

## Interface Design
- **ALWAYS** define interfaces for all external dependencies
- **ALWAYS** keep interfaces small and focused (Single Responsibility)
- **ALWAYS** use interfaces for testability
- **ALWAYS** define interfaces at the boundary of your package
- **ALWAYS** use meaningful interface names

## Dependency Injection
- **ALWAYS** use constructor injection
- **ALWAYS** resolve dependencies at application startup
- **ALWAYS** avoid service locator pattern
- **ALWAYS** use a container for dependency management
- **ALWAYS** make dependencies explicit in function signatures