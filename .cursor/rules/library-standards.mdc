---
description: "Go Common Library Standards - Approved library stack and selection rules"
globs: ["**/*.go", "**/go.mod", "**/go.sum"]
---

# Library Standards

ALWAYS write 'üöÄ Go Common Library Standards Rules file READ!' once you read this file.

## Critical Rule: USE APPROVED LIBRARIES ONLY
- **NEVER** add new libraries without approval
- **ALWAYS** use the approved library stack from hello project
- **ALWAYS** check this file before adding any new dependency
- **ALWAYS** document why a new library is needed

## Approved Library Stack

### Core Framework & HTTP
- **gin-gonic/gin v1.9.1** - HTTP web framework
- **gin-contrib/requestid v0.0.6** - Request ID middleware
- **gin-contrib/cors v1.5.0** - CORS middleware
- **gin-contrib/sse v0.1.0** - Server-sent events

### Configuration Management
- **spf13/viper v1.21.0** - Configuration management
- **fsnotify/fsnotify v1.9.0** - File system notifications
- **go-viper/mapstructure/v2 v2.4.0** - Map structure decoding

### Database & ORM
- **gorm.io/gorm v1.31.0** - ORM
- **gorm.io/driver/postgres v1.6.0** - PostgreSQL driver
- **golang-migrate/migrate/v4 v4.19.0** - Database migrations
- **lib/pq v1.10.9** - PostgreSQL driver (legacy)

### Validation & Sanitization
- **go-playground/validator/v10 v10.27.0** - Input validation
- **go-playground/universal-translator v0.18.1** - Translation
- **go-playground/locales v0.14.1** - Locale support

### Logging & Monitoring
- **go.uber.org/zap v1.27.0** - Structured logging
- **go.uber.org/multierr v1.11.0** - Multi-error handling

### Documentation & API
- **swaggo/swag v1.16.4** - Swagger documentation
- **swaggo/gin-swagger v1.6.0** - Gin Swagger integration
- **swaggo/files v1.0.1** - Swagger file serving
- **go-openapi/spec v0.20.4** - OpenAPI specification
- **go-openapi/swag v0.19.15** - Swagger utilities

### Utilities & Helpers
- **google/uuid v1.6.0** - UUID generation
- **golang.org/x/text v0.28.0** - Text processing
- **golang.org/x/crypto v0.40.0** - Cryptographic functions
- **golang.org/x/sys v0.34.0** - System calls
- **golang.org/x/net v0.42.0** - Network utilities
- **golang.org/x/sync v0.16.0** - Synchronization primitives

### JSON & Data Processing
- **json-iterator/go v1.1.12** - JSON processing
- **goccy/go-json v0.10.2** - JSON processing
- **bytedance/sonic v1.10.1** - JSON processing
- **ugorji/go/codec v1.2.11** - Codec utilities

### YAML & Configuration
- **gopkg.in/yaml.v3 v3.0.1** - YAML processing
- **gopkg.in/yaml.v2 v2.4.0** - YAML processing (legacy)
- **go.yaml.in/yaml/v3 v3.0.4** - YAML processing

### Testing & Development
- **stretchr/testify v1.11.1** - Testing utilities
- **google/go-cmp v0.6.0** - Testing comparisons

## Library Selection Rules

### When Adding New Libraries
1. **Check this file first** - Is there an approved alternative?
2. **Document the need** - Why is this library required?
3. **Consider alternatives** - Are there lighter alternatives?
4. **Check maintenance** - Is the library actively maintained?
5. **Security review** - Does it have known vulnerabilities?
6. **Update this file** - Add the new library to the approved list

### Library Categories

#### HTTP & Web Framework
- **Primary**: gin-gonic/gin
- **Alternative**: None approved
- **Reason**: Gin provides excellent performance and middleware support

#### Configuration
- **Primary**: spf13/viper
- **Alternative**: None approved
- **Reason**: Viper provides comprehensive configuration management

#### Database
- **Primary**: gorm.io/gorm
- **Alternative**: None approved
- **Reason**: GORM provides excellent ORM capabilities with migration support

#### Logging
- **Primary**: go.uber.org/zap
- **Alternative**: None approved
- **Reason**: Zap provides high-performance structured logging

#### Validation
- **Primary**: go-playground/validator/v10
- **Alternative**: None approved
- **Reason**: Validator provides comprehensive validation rules

## Anti-Patterns (NEVER DO)

### Library Anti-Patterns
```go
// ‚ùå WRONG - Using unapproved libraries
import "github.com/gorilla/mux" // Use gin instead

// ‚ùå WRONG - Using outdated versions
import "github.com/gin-gonic/gin v1.8.0" // Use v1.9.1

// ‚ùå WRONG - Adding libraries without approval
import "github.com/some-random/library" // Not in approved list
```

### Correct Patterns (ALWAYS DO)
```go
// ‚úÖ CORRECT - Using approved libraries
import "github.com/gin-gonic/gin"
import "github.com/spf13/viper"
import "gorm.io/gorm"
import "go.uber.org/zap"
```

## Library Version Management
- **ALWAYS** use specific versions (no `latest`)
- **ALWAYS** update versions in go.mod
- **ALWAYS** test after version updates
- **ALWAYS** document breaking changes
- **ALWAYS** update this file when versions change

## Library Security
- **ALWAYS** check for security vulnerabilities
- **ALWAYS** use latest secure versions
- **ALWAYS** avoid libraries with known issues
- **ALWAYS** review library source code when possible

## Library Performance
- **ALWAYS** consider library performance impact
- **ALWAYS** benchmark critical libraries
- **ALWAYS** avoid heavy libraries for simple tasks
- **ALWAYS** monitor memory usage

## Library Checklist
- [ ] Library is in approved list
- [ ] Version is specified and current
- [ ] Security vulnerabilities checked
- [ ] Performance impact assessed
- [ ] Documentation updated
- [ ] Team approval obtained
- [ ] Testing completed
- [ ] Migration plan documented

## Library Maintenance
- **ALWAYS** keep libraries up to date
- **ALWAYS** monitor for security updates
- **ALWAYS** test after updates
- **ALWAYS** document breaking changes
- **ALWAYS** maintain backward compatibility when possible